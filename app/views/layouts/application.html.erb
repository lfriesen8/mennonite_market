<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= content_for(:title) || "Mennonite Market" %></title>
  
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>

  <!-- Load style first -->
  <%= stylesheet_link_tag 'application', media: 'all' %>
  <%= stylesheet_link_tag 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css', media: 'all' %>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-dark mb-4">
    <div class="container-fluid">
      <%= link_to 'Mennonite Market', root_path, class: 'navbar-brand custom-logo' %>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <h2 class="text-white ms-3">BY FRIESEN FOODS</h2>
      
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <%= link_to 'Home', root_path, class: 'nav-link text-white' %>
          </li>
          <li class="nav-item">
            <%= link_to 'About', page_path(slug: 'about'), class: 'nav-link text-white' %>
          </li>
          <li class="nav-item">
            <%= link_to 'Contact', page_path(slug: 'contact'), class: 'nav-link text-white' %>
          </li>
          <li class="nav-item">
  <%= link_to view_cart_path, class: 'btn btn-outline-light ms-2 custom-cart-btn' do %>
    <i class="bi bi-cart-fill me-1"></i> View Cart
  <% end %>
 <% if defined?(user_signed_in?) && user_signed_in? %>
  <%= link_to 'Logout', destroy_user_session_path, method: :delete, class: 'btn btn-outline-light btn-sm' %>
<% else %>
  <%= link_to 'Login', new_user_session_path, class: 'btn btn-outline-light btn-sm me-2' %>
  <%= link_to 'Sign Up', new_user_registration_path, class: 'btn btn-outline-light btn-sm' %>
<% end %>


</li>
     </li>
        </ul>

        <!-- Inline Search Form in Navbar -->
        <%= form_tag root_path, method: :get, class: 'd-flex ms-3 align-items-center' do %>
          <input class="form-control form-control-sm me-2" type="search" name="query" placeholder="Search" aria-label="Search" style="max-width: 150px;">
          <select class="form-select form-select-sm me-2" name="category_id" style="max-width: 150px;">
            <option value="">All Categories</option>
            <% @categories.each do |category| %>
              <option value="<%= category.id %>"><%= category.name %></option>
            <% end %>
          </select>
          <button class="btn btn-sm btn-outline-light" type="submit">Search</button>
        <% end %>
      </div>
    </div>
  </nav>

  <!-- Main content will be inserted here -->
  <div class="container">
    <%= yield %>
  </div>

  <!-- Optional Bootstrap JS -->
  <%= javascript_include_tag 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js' %>
  <%= javascript_include_tag 'application', 'data-turbo-track': 'reload' %>
</body>
</html>